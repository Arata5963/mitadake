# コメントガイドライン

コードリーディングしやすくするためのコメントルール。

## 5種類のコメント

### 1. ファイルの役割（ファイル冒頭）

```ruby
# ファイル名
# ==========================================
# 一言でわかる説明
# ==========================================
#
# 【使い方】普段どう使っているか
#
# ==========================================
```

**書く場所**: ファイルの先頭
**目的**: 「このファイル何？」に答える

---

### 2. WHY（なぜこうしているか）

```ruby
# 無料プランはメモリ制限があるため少なめに設定
pool: 2

# N+1問題を防ぐため事前読み込み
Post.includes(:user, :comments)
```

**書く場所**: コードの直前
**目的**: コードを見ただけではわからない理由を説明

---

### 3. 注意点・罠

```ruby
# ⚠️ この順番を変えると起動しなくなる
require_relative "config/application"
Rails.application.load_tasks

# 注意: nil の場合は空配列を返す（エラーにしない）
def items
  @items || []
end
```

**書く場所**: 危険なコードの直前
**目的**: 将来の自分やチームメンバーへの警告

---

### 4. 複雑なロジックの要約

```ruby
# YouTube URLから動画IDを抽出し、APIで情報を取得
def fetch_video_info(url)
  video_id = extract_video_id(url)
  return nil unless video_id

  response = youtube_api.get_video(video_id)
  # ...長い処理...
end
```

**書く場所**: 複雑なメソッド・処理の直前
**目的**: 全体を読まなくても概要がわかる

---

### 5. 関連ファイル

```ruby
# 【関連ファイル】
#   - bin/dev → このファイルを読み込む
#   - config/puma.rb → サーバー設定
```

**書く場所**: ファイル冒頭（ファイルの役割と一緒に）
**目的**: ファイル間の繋がりを明確にする

---

## 書かなくて良いコメント

| 種類 | 理由 |
|------|------|
| コードの直訳 | `user.save # ユーザーを保存` → コード見ればわかる |
| パラメータ・戻り値 | メソッド名と型でわかる / 複雑なら4で対応 |
| 使用例 | テストを見ればわかる |
| 変更履歴 | Git で追える |
| TODO/FIXME | GitHub Issues で管理 |

---

## フォーマット

- 区切り線: `# ==========================================`
- 見出し: `# 【見出し】`
- 警告: `# ⚠️` または `# 注意:`
- 矢印で流れを表現: `↓` `→`

---

*最終更新: 2026-01-21*
