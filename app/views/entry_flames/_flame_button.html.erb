<%# app/views/entry_flames/_flame_button.html.erb %>
<%# アクションプラン用の炎ボタン %>

<div id="flame_button_<%= post_entry.id %>" class="inline-flex items-center">
  <% if user_signed_in? %>
    <% if post_entry.flamed_by?(current_user) %>
      <%# 炎マーク済み（オレンジ色で塗りつぶし） %>
      <% flame = post_entry.entry_flames.find_by(user: current_user) %>
      <%= button_to post_post_entry_entry_flame_path(post_entry.post, post_entry, flame),
                    method: :delete,
                    data: { turbo_frame: "_top" },
                    class: "inline-flex items-center gap-1 text-orange-500 hover:text-orange-400 transition-colors" do %>
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="currentColor">
          <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/>
        </svg>
        <% if post_entry.entry_flames.count > 0 %>
          <span class="text-xs font-medium"><%= post_entry.entry_flames.count %></span>
        <% end %>
      <% end %>
    <% else %>
      <%# 未炎マーク（グレー・枠線のみ） %>
      <%= button_to post_post_entry_entry_flames_path(post_entry.post, post_entry),
                    method: :post,
                    data: { turbo_frame: "_top" },
                    class: "inline-flex items-center gap-1 text-gray-400 hover:text-orange-400 transition-colors" do %>
        <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/>
        </svg>
        <% if post_entry.entry_flames.count > 0 %>
          <span class="text-xs font-medium"><%= post_entry.entry_flames.count %></span>
        <% end %>
      <% end %>
    <% end %>
  <% else %>
    <%# 未ログイン（グレー） %>
    <div class="inline-flex items-center gap-1 text-gray-400">
      <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
        <path d="M13.5.67s.74 2.65.74 4.8c0 2.06-1.35 3.73-3.41 3.73-2.07 0-3.63-1.67-3.63-3.73l.03-.36C5.21 7.51 4 10.62 4 14c0 4.42 3.58 8 8 8s8-3.58 8-8C20 8.61 17.41 3.8 13.5.67zM11.71 19c-1.78 0-3.22-1.4-3.22-3.14 0-1.62 1.05-2.76 2.81-3.12 1.77-.36 3.6-1.21 4.62-2.58.39 1.29.59 2.65.59 4.04 0 2.65-2.15 4.8-4.8 4.8z"/>
      </svg>
      <% if post_entry.entry_flames.count > 0 %>
        <span class="text-xs font-medium"><%= post_entry.entry_flames.count %></span>
      <% end %>
    </div>
  <% end %>
</div>
