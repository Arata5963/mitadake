<%# app/views/post_entries/designs/_entry_card_discord.html.erb %>
<%# DiscordÈ¢®„Éá„Ç∂„Ç§„É≥ - „ÉÄ„Éº„ÇØ„É¢„Éº„Éâ„ÄÅ„Ç≥„É≥„Éë„ÇØ„Éà„ÄÅ„Ç≤„Éº„Éü„É≥„Ç∞È¢® %>

<%= turbo_frame_tag dom_id(entry) do %>
<article class="group" style="padding: 4px 16px 4px 72px; position: relative; transition: background-color 0.1s;"
         onmouseover="this.style.backgroundColor='#2e3035';"
         onmouseout="this.style.backgroundColor='transparent';">

  <%# „Ç¢„Éê„Çø„ÉºÔºàÂ∑¶ÂÅ¥Âõ∫ÂÆöÔºâ %>
  <div style="position: absolute; left: 16px; top: 4px;">
    <% if entry.display_avatar.present? %>
      <%= image_tag entry.display_avatar.url, style: "width: 40px; height: 40px; border-radius: 50%; object-fit: cover;" %>
    <% else %>
      <%# Discord„Å£„ÅΩ„ÅÑ„Ç´„É©„Éï„É´„Å™„Ç¢„Éê„Çø„Éº %>
      <% colors = ['#5865f2', '#57f287', '#fee75c', '#eb459e', '#ed4245'] %>
      <% avatar_color = colors[entry.display_user_name.to_s.bytes.sum % colors.length] %>
      <div style="width: 40px; height: 40px; border-radius: 50%; background: <%= avatar_color %>; display: flex; align-items: center; justify-content: center;">
        <span style="font-size: 18px; font-weight: 600; color: white;"><%= entry.display_user_name&.first&.upcase || '?' %></span>
      </div>
    <% end %>
  </div>

  <%# „Éò„ÉÉ„ÉÄ„ÉºË°å %>
  <div style="display: flex; align-items: baseline; gap: 8px;">
    <%# „É¶„Éº„Ç∂„ÉºÂêçÔºà„É≠„Éº„É´Ëâ≤È¢®Ôºâ %>
    <% name_colors = ['#f47b67', '#f2a860', '#57f287', '#5cc9f5', '#e090f0'] %>
    <% name_color = name_colors[entry.display_user_name.to_s.bytes.sum % name_colors.length] %>
    <span style="font-size: 16px; font-weight: 500; color: <%= name_color %>;">
      <%= entry.display_user_name %>
    </span>

    <%# „Éê„ÉÉ„Ç∏ÔºàÈÅîÊàêÊ∏à„Åø„ÅÆÂ†¥ÂêàÔºâ %>
    <% if entry.achieved? %>
      <span style="font-size: 10px; padding: 1px 4px; background: #57f287; color: #1e1f22; border-radius: 3px; font-weight: 600; text-transform: uppercase;">Done</span>
    <% end %>

    <%# „Çø„Ç§„É†„Çπ„Çø„É≥„Éó %>
    <span style="font-size: 12px; color: #949ba4;">
      <%= entry.created_at.strftime("%Y/%m/%d %H:%M") %>
    </span>
  </div>

  <%# „É°„ÉÉ„Çª„Éº„Ç∏Êú¨Êñá %>
  <div style="font-size: 16px; line-height: 1.375; color: <%= entry.achieved? ? '#72767d' : '#dbdee1' %>; margin-top: 2px; <%= 'text-decoration: line-through;' if entry.achieved? %>">
    <%= entry.content %>
  </div>

  <%# ÊúüÈôêÔºàÂüã„ÇÅËæº„ÅøÈ¢®Ôºâ %>
  <% if entry.deadline.present? %>
    <% is_overdue = entry.deadline < Date.current && !entry.achieved? %>
    <div style="display: inline-block; margin-top: 8px; padding: 8px 12px; background: #2b2d31; border-left: 4px solid <%= is_overdue ? '#ed4245' : '#5865f2' %>; border-radius: 4px;">
      <div style="font-size: 12px; font-weight: 600; color: <%= is_overdue ? '#ed4245' : '#00a8fc' %>; margin-bottom: 4px;">
        üìÖ ÊúüÈôê
      </div>
      <div style="font-size: 14px; color: #dbdee1;">
        <%= l(entry.deadline, format: :long) %>
        <% if is_overdue %>
          <span style="color: #ed4245; font-weight: 500;"> (ÊúüÈôêÂàá„Çå)</span>
        <% elsif entry.deadline == Date.current %>
          <span style="color: #fee75c; font-weight: 500;"> (‰ªäÊó•)</span>
        <% end %>
      </div>
    </div>
  <% end %>

  <%# „Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥Ôºà„Éõ„Éê„ÉºÊôÇÔºâ %>
  <div class="opacity-0 group-hover:opacity-100 transition-opacity" style="position: absolute; right: 16px; top: 50%; transform: translateY(-50%); display: flex; gap: 4px; background: #1e1f22; border-radius: 4px; padding: 4px;">
    <% if user_signed_in? && entry.user == current_user && !entry.achieved? %>
      <%= button_to achieve_post_post_entry_path(entry.post, entry),
            method: :patch,
            style: "width: 32px; height: 32px; background: none; border: none; cursor: pointer; border-radius: 4px; display: flex; align-items: center; justify-content: center; transition: background-color 0.1s;",
            title: "ÂÆå‰∫Ü",
            form: { data: { turbo_confirm: "ÈÅîÊàê„Åó„Åæ„Åô„ÅãÔºü" } },
            onmouseover: "this.style.backgroundColor='#3c3f45'",
            onmouseout: "this.style.backgroundColor='transparent'" do %>
        <svg style="width: 20px; height: 20px; color: #b5bac1;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7"/>
        </svg>
      <% end %>
    <% end %>

    <%= link_to post_path(entry.post), style: "width: 32px; height: 32px; text-decoration: none; border-radius: 4px; display: flex; align-items: center; justify-content: center; transition: background-color 0.1s;", data: { turbo_frame: "_top" }, title: "ÂãïÁîª",
          onmouseover: "this.style.backgroundColor='#3c3f45'",
          onmouseout: "this.style.backgroundColor='transparent'" do %>
      <svg style="width: 20px; height: 20px; color: #b5bac1;" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/>
      </svg>
    <% end %>

    <% if user_signed_in? && entry.user == current_user %>
      <%= button_to post_post_entry_path(entry.post, entry),
            method: :delete,
            data: { turbo_confirm: "ÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü" },
            style: "width: 32px; height: 32px; background: none; border: none; cursor: pointer; border-radius: 4px; display: flex; align-items: center; justify-content: center; transition: background-color 0.1s;",
            title: "ÂâäÈô§",
            onmouseover: "this.style.backgroundColor='#da373c'",
            onmouseout: "this.style.backgroundColor='transparent'" do %>
        <svg style="width: 20px; height: 20px; color: #b5bac1;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path stroke-linecap="round" stroke-linejoin="round" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"/>
        </svg>
      <% end %>
    <% end %>
  </div>
</article>
<% end %>
